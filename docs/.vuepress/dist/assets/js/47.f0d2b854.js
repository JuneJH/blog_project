(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{433:function(t,s,a){"use strict";a.r(s);var n=a(54),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"cross-origin-resource-sharing-跨域资源共享"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cross-origin-resource-sharing-跨域资源共享"}},[t._v("#")]),t._v(" Cross-Origin-Resource-Sharing 跨域资源共享")]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("CORS")]),t._v("是在"),a("code",[t._v("HTTP1.1")]),t._v("提出的一种跨域解决方案\n跨域是浏览器对我们的安全保护，如果服务器同意使用该资源，那么这种保护就没有必要了\n简单请求-对服务器资源不会造成太大的影响\n与之相反的则需要发送预捡请求再发送真实请求")])]),t._v(" "),a("h2",{attrs:{id:"简单请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简单请求"}},[t._v("#")]),t._v(" 简单请求")]),t._v(" "),a("blockquote",[a("p",[t._v("请求方法为"),a("code",[t._v("get")]),t._v(","),a("code",[t._v("post")]),t._v(","),a("code",[t._v("head")]),t._v("\n请求头只包含安全字段"),a("code",[t._v("Accept")]),t._v(","),a("code",[t._v("Accept-Language")]),t._v(","),a("code",[t._v("Content-Language")]),t._v(","),a("code",[t._v("Content-Type")]),t._v(","),a("code",[t._v("DPR")]),t._v(","),a("code",[t._v("Downlink")]),t._v(","),a("code",[t._v("Save-Data")]),t._v(","),a("code",[t._v("Viewport-Width")]),t._v(","),a("code",[t._v("Width")]),t._v("\n其中"),a("code",[t._v("Content-Type")]),t._v("只能为"),a("code",[t._v("text/plain")]),t._v(","),a("code",[t._v("mutipart/form-data")]),t._v(","),a("code",[t._v("application/x-www-form-urlencoded")]),t._v("中一个值\n"),a("strong",[t._v("同时满足以上三条，则为简单请求")])])]),t._v(" "),a("h3",{attrs:{id:"示例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[t._v("#")]),t._v(" 示例")]),t._v(" "),a("blockquote",[a("p",[t._v("Nodejs\nexpress框架\nfetch")])]),t._v(" "),a("ol",[a("li",[t._v("客户端发送一个请求学生列表")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://127.0.0.1:9527/student"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                method"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"get"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("服务器端设置"),a("code",[t._v("Access-Control-Allow-Origin")]),t._v("来应对简单请求的跨域")])]),t._v(" "),a("blockquote",[a("p",[a("code",[t._v("Access-Control-Allow-Origin")]),t._v(" 的值可以为"),a("code",[t._v("*")]),t._v("或者具体的源(可通过请求头获取，浏览器为用户发送简单请求自动添加"),a("code",[t._v("Origin")]),t._v("属性)\n"),a("code",[t._v("*")]),t._v("表示所有允许所有源访问，"),a("strong",[t._v("如果请求需要携带身份凭证，则不允许设置该值")]),t._v("\n具体的源表示只针对该域进行跨域访问(服务器可维护可跨域访问资源白名单)")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("  res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Access-Control-Allow-Origin"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("origin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("请求头")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("    Accept"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" */\\*\n    Accept-Encoding"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" gzip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" deflate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" br\n    Accept-Language"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" zh-CN"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("zh;q="),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("en;q="),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.8")]),t._v("\n    Cache-Control"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" no-cache\n    Connection"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" keep-alive\n    Host"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v("."),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9527")]),t._v("\n    Origin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//localhost:63342   // 浏览器为其添加该属性，指定具体的源")]),t._v("\n    Pragma"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" no-cache\n    Referer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//localhost:63342/")]),t._v("\n    Sec-Fetch-Dest"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" empty\n    Sec-Fetch-Mode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" cors\n    Sec-Fetch-Site"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" cross-site\n    User-Agent"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Mozilla/"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.0")]),t._v(" (Windows NT "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.0")]),t._v("; Win64; x64) AppleWebKit/"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("537.36")]),t._v(" (KHTML"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" like Gecko) Chrome/"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("87.0")]),t._v("."),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4280.66")]),t._v(" Safari/"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("537.36")]),t._v("\n")])])]),a("ol",{attrs:{start:"4"}},[a("li",[t._v("响应头")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("    Access-Control-Allow-Origin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//localhost:63342   // 服务器为其设置可访问源")]),t._v("\n    Connection"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" keep-alive\n    Content-Length"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("17215")]),t._v("\n    Content-Type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" application/json; charset=utf"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("-8")]),t._v("\n    Date"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Thu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("02")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("28")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("36")]),t._v(" GMT\n    ETag"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" W/"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"433f-QlFxK67TOrn0mHqplU4/RdfiIoY"')]),t._v("\n    X-Powered-By"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Express\n")])])]),a("h2",{attrs:{id:"需要发送预检的请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#需要发送预检的请求"}},[t._v("#")]),t._v(" 需要发送预检的请求")]),t._v(" "),a("blockquote",[a("p",[t._v("在不满足简单请求的三大条，那么浏览器将为他先发送一条预检请求\n得到服务器允许后再发送真实请求")])]),t._v(" "),a("h3",{attrs:{id:"预检请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#预检请求"}},[t._v("#")]),t._v(" 预检请求")]),t._v(" "),a("blockquote",[a("p",[t._v("预检请求是浏览器再确定真是请求非简单请求自行发送给服务端的请求\n该请求的方法为"),a("code",[t._v("OPTIONS")]),t._v("\n只有请求头，没有消息体，也没有我们所设置的请求头\n其中包含了一下请求头")]),t._v(" "),a("ol",[a("li",[t._v("origin:具体的源")]),t._v(" "),a("li",[t._v("Access-Control-Request-Method:真实请求使用的请求方法")]),t._v(" "),a("li",[t._v("Access-Control-Request-Headers:真实请求的添加或者改变的请求头")])])]),t._v(" "),a("h4",{attrs:{id:"_1-真实请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-真实请求"}},[t._v("#")]),t._v(" 1. 真实请求")]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("      "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://127.0.0.1:9527/student"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            method"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"get"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            headers"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                myHeader"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"this is my header"')]),t._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 因为添加了请求头，因此不满足简单请求")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h4",{attrs:{id:"_2-客户端准备预捡请求"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-客户端准备预捡请求"}},[t._v("#")]),t._v(" 2. 客户端准备预捡请求")]),t._v(" "),a("p",[t._v("当浏览器发现不是简单请求后，自行组装一个预捡请求")]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// √是需要关注的地方")]),t._v("\n  √ OPTIONS /student HTTP/"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.1")]),t._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 该请求为OPTIOINS")]),t._v("\n    Host"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v("."),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("9527")]),t._v("\n    Connection"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" keep-alive\n    Pragma"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" no-cache\n    Cache-Control"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" no-cache\n    Accept"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" */\\*\n  √ Access-Control-Request-Method"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" GET       "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 真实请求的请求方法")]),t._v("\n  √ Access-Control-Request-Headers"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" myheader "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 真实请求所添加和改变的请求头   ")]),t._v("\n  √ Origin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//localhost:63342          // 浏览器组装具体的源")]),t._v("\n    User-Agent"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Mozilla/"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("5.0")]),t._v(" (Windows NT "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("10.0")]),t._v("; Win64; x64) AppleWebKit/"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("537.36")]),t._v(" (KHTML"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" like Gecko) Chrome/"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("87.0")]),t._v("."),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4280.66")]),t._v(" Safari/"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("537.36")]),t._v("\n    Sec-Fetch-Mode"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" cors\n    Sec-Fetch-Site"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" cross-site\n    Sec-Fetch-Dest"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" empty\n    Referer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//localhost:63342/")]),t._v("\n    Accept-Encoding"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" gzip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" deflate"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" br\n    Accept-Language"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" zh-CN"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("zh;q="),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.9")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("en;q="),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0.8")]),t._v("\n")])])]),a("h4",{attrs:{id:"_3-服务端需要对预检请求响应-否则将不再进行跨域资源共享"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-服务端需要对预检请求响应-否则将不再进行跨域资源共享"}},[t._v("#")]),t._v(" 3. 服务端需要对预检请求响应，否则将不再进行跨域资源共享")]),t._v(" "),a("blockquote",[a("p",[t._v("但服务器收到预捡请求后，必须给予响应，并且需要包含以下请求头")]),t._v(" "),a("ol",[a("li",[t._v("Access-Control-Allow-Origin:允许的具体的源")]),t._v(" "),a("li",[t._v("Access-Control-Allow-Methods:对应预捡请求的"),a("code",[t._v("Access-Control-Request-Method")]),t._v(",表示我服务端所允许的请求方法")]),t._v(" "),a("li",[t._v("Access-Control-Allow-Headers:对应预检请求的"),a("code",[t._v("Access-Control-Request-Headers")]),t._v(",表示我服务端允许改动的请求头")]),t._v(" "),a("li",[t._v("? Access-Control-Allow-Max-Age: 可选的 设置再此时间段，对于与本次相同的请求(预检请求所必带请求头的值相同)，浏览器都不需要再发送预检请求")])])]),t._v(" "),a("ol",[a("li",[t._v("服务端设置")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("method "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"OPTIONS"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Access-control-allow-method"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"access-control-request-method"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Access-Control-allow-headers"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("req"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"access-control-request-headers"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setHeader")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Access-Control-Max-Age"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 需要将浏览器的缓存打开Disable cache")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("服务端响应给预检请求")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("    Access-Control-allow-headers"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" myheader\n    Access-control-allow-method"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" GET\n    Access-Control-Allow-Origin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//localhost:63342")]),t._v("\n    Access-Control-Max-Age"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1000")]),t._v("\n    Allow"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" GET"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("POST"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("HEAD\n    Connection"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" keep-alive\n    Content-Length"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("13")]),t._v("\n    Content-Type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" text/html; charset=utf"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("-8")]),t._v("\n    Date"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Thu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("03")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("36")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("58")]),t._v(" GMT\n    ETag"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" W/"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"d-5V0bEbsSC17Ya0KqDVcZsTZ+vh8"')]),t._v("\n    X-Powered-By"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Express\n")])])]),a("h3",{attrs:{id:"真实请求就与常规相同"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#真实请求就与常规相同"}},[t._v("#")]),t._v(" 真实请求就与常规相同")]),t._v(" "),a("h2",{attrs:{id:"附带身份验证信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#附带身份验证信息"}},[t._v("#")]),t._v(" 附带身份验证信息")]),t._v(" "),a("blockquote",[a("p",[t._v("一个请求如果需要带cookie这样的身份信息，必须征得服务器的同意，否则一切请求浏览器都会视为跨域处理\n服务器端设置响应头"),a("code",[t._v("Access-Control-Allow-Credentials:true")]),t._v("即可，表明服务端需要携带身份认证信息\n"),a("strong",[t._v("注意：该响应头无论是简单请求还是预检请求都需要得到服务器的认证")])])]),t._v(" "),a("ol",[a("li",[t._v("客户端修改请求")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://127.0.0.1:9527/student"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                method"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"get"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                headers"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    myHeader"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"this is my header"')]),t._v("\n                "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                credentials"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"include"')]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果是ajax，为其withCredentials属性设置为true")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("服务端设置")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("header")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Access-Control-Allow-Credentials"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("h2",{attrs:{id:"修成正果-客户端收到服务端的跨域资源"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修成正果-客户端收到服务端的跨域资源"}},[t._v("#")]),t._v(" 修成正果:客户端收到服务端的跨域资源")]),t._v(" "),a("blockquote",[a("p",[t._v("此时服务端不设置任何响应头属性，JavaScript只能拿到部分安全的响应头\n如果需要拿到自定义的一些响应头，需要服务端设置"),a("code",[t._v("Access-Control-Expose-Headers")]),t._v("\n该属性的值则表示服务端允许JavaScript操作的一些响应头")])]),t._v(" "),a("h3",{attrs:{id:"获取自定义响应头"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取自定义响应头"}},[t._v("#")]),t._v(" 获取自定义响应头")]),t._v(" "),a("ol",[a("li",[t._v("服务端")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("header")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my-header"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"this is come from service!!!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ol",{attrs:{start:"2"}},[a("li",[t._v("客户端")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("fetch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://127.0.0.1:9527/student"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            method"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"get"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            headers"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                myHeader"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"this is my header"')]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            credentials"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"include"')]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("headers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my-header"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// this is come from service!!!")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("json")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("data")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("ol",{attrs:{start:"3"}},[a("li",[t._v("不修改客户端代码，但是开起一个跨域的服务，跨域访问资源")])]),t._v(" "),a("p",[t._v("控制输入:```null``")]),t._v(" "),a("ol",{attrs:{start:"4"}},[a("li",[t._v("服务端允许操作"),a("code",[t._v("my-header")]),t._v("响应头")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("header")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my-header"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"this is come from service!!!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("header")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my-header1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"this is come from service!!!"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    res"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("header")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Access-Control-Expose-Headers"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my-header,my-header1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[a("strong",[t._v("一切正常")])]),t._v(" "),a("ul",[a("li",[t._v("响应头")])]),t._v(" "),a("div",{staticClass:"language-json extra-class"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[t._v("    Access-Control-Allow-Credentials"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),t._v("\n    Access-Control-Allow-Origin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" http"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//localhost:63342")]),t._v("\n    Access-Control-Expose-Headers"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" my-header"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("my-header1\n    Connection"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" keep-alive\n    Content-Length"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("17215")]),t._v("\n    Content-Type"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" application/json; charset=utf"),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("-8")]),t._v("\n    Date"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Thu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("26")]),t._v(" Nov "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2020")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("06")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("56")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("06")]),t._v(" GMT\n    ETag"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" W/"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"433f-QlFxK67TOrn0mHqplU4/RdfiIoY"')]),t._v("\n    my-header"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" this is come from service!!!\n    my-header1"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" this is come from service!!!\n    X-Powered-By"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Express\n")])])]),a("h2",{attrs:{id:"最后"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最后"}},[t._v("#")]),t._v(" 最后")]),t._v(" "),a("blockquote",[a("p",[t._v("虽然此处是使用Node环境，但是CORS流程是相同的\n本文主要基于自定义中间件，但是实际开发可以使用```cors``中间件"),a("a",{attrs:{href:"https://github.com/expressjs/cors",target:"_blank",rel:"noopener noreferrer"}},[t._v("github"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);