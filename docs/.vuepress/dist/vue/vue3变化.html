<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>vue3的性能 | JuneJH</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.75473690.js" as="script"><link rel="preload" href="/assets/js/2.8c11f49f.js" as="script"><link rel="preload" href="/assets/js/100.acece0c3.js" as="script"><link rel="prefetch" href="/assets/js/10.b610653e.js"><link rel="prefetch" href="/assets/js/101.44645056.js"><link rel="prefetch" href="/assets/js/102.54d7cbc3.js"><link rel="prefetch" href="/assets/js/103.6f06f068.js"><link rel="prefetch" href="/assets/js/104.7c59b56b.js"><link rel="prefetch" href="/assets/js/105.51190178.js"><link rel="prefetch" href="/assets/js/106.bd33d190.js"><link rel="prefetch" href="/assets/js/11.4cb3b0d6.js"><link rel="prefetch" href="/assets/js/12.529c3674.js"><link rel="prefetch" href="/assets/js/13.0982f329.js"><link rel="prefetch" href="/assets/js/14.7c2b2b32.js"><link rel="prefetch" href="/assets/js/15.2b4bb874.js"><link rel="prefetch" href="/assets/js/16.98b60686.js"><link rel="prefetch" href="/assets/js/17.95b8444a.js"><link rel="prefetch" href="/assets/js/18.07af37ef.js"><link rel="prefetch" href="/assets/js/19.7b44b462.js"><link rel="prefetch" href="/assets/js/20.ee427676.js"><link rel="prefetch" href="/assets/js/21.a14af8ea.js"><link rel="prefetch" href="/assets/js/22.3a9b3af4.js"><link rel="prefetch" href="/assets/js/23.3a0666fc.js"><link rel="prefetch" href="/assets/js/24.f46b71ee.js"><link rel="prefetch" href="/assets/js/25.c7fefb91.js"><link rel="prefetch" href="/assets/js/26.7fb6ce6c.js"><link rel="prefetch" href="/assets/js/27.52c72a07.js"><link rel="prefetch" href="/assets/js/28.ed2832e4.js"><link rel="prefetch" href="/assets/js/29.c7c3cab2.js"><link rel="prefetch" href="/assets/js/3.4e83e6d5.js"><link rel="prefetch" href="/assets/js/30.b58c173c.js"><link rel="prefetch" href="/assets/js/31.18aaf55d.js"><link rel="prefetch" href="/assets/js/32.e9222cf3.js"><link rel="prefetch" href="/assets/js/33.0e78dad4.js"><link rel="prefetch" href="/assets/js/34.37cc3f94.js"><link rel="prefetch" href="/assets/js/35.d81a1c3f.js"><link rel="prefetch" href="/assets/js/36.0bfb58b5.js"><link rel="prefetch" href="/assets/js/37.47e6e68a.js"><link rel="prefetch" href="/assets/js/38.546525ad.js"><link rel="prefetch" href="/assets/js/39.50e48d08.js"><link rel="prefetch" href="/assets/js/4.fbcf4621.js"><link rel="prefetch" href="/assets/js/40.dfd04ada.js"><link rel="prefetch" href="/assets/js/41.46d81a34.js"><link rel="prefetch" href="/assets/js/42.33bdc7f6.js"><link rel="prefetch" href="/assets/js/43.2fef28c5.js"><link rel="prefetch" href="/assets/js/44.2f4a281a.js"><link rel="prefetch" href="/assets/js/45.15d41b73.js"><link rel="prefetch" href="/assets/js/46.9effb5bd.js"><link rel="prefetch" href="/assets/js/47.f0d2b854.js"><link rel="prefetch" href="/assets/js/48.cd8d9787.js"><link rel="prefetch" href="/assets/js/49.d228fe29.js"><link rel="prefetch" href="/assets/js/5.ec4b3f90.js"><link rel="prefetch" href="/assets/js/50.a22eebad.js"><link rel="prefetch" href="/assets/js/51.46408fe9.js"><link rel="prefetch" href="/assets/js/52.a0743a7e.js"><link rel="prefetch" href="/assets/js/53.3e998c97.js"><link rel="prefetch" href="/assets/js/54.35e95df8.js"><link rel="prefetch" href="/assets/js/55.133842e1.js"><link rel="prefetch" href="/assets/js/56.6353ecc5.js"><link rel="prefetch" href="/assets/js/57.164fc5aa.js"><link rel="prefetch" href="/assets/js/58.07e04701.js"><link rel="prefetch" href="/assets/js/59.62c11d67.js"><link rel="prefetch" href="/assets/js/6.27888615.js"><link rel="prefetch" href="/assets/js/60.b07fa48a.js"><link rel="prefetch" href="/assets/js/61.89a60286.js"><link rel="prefetch" href="/assets/js/62.5e4788b3.js"><link rel="prefetch" href="/assets/js/63.ea50b78c.js"><link rel="prefetch" href="/assets/js/64.1cca3bdb.js"><link rel="prefetch" href="/assets/js/65.4147e986.js"><link rel="prefetch" href="/assets/js/66.3650f7a3.js"><link rel="prefetch" href="/assets/js/67.4ed02925.js"><link rel="prefetch" href="/assets/js/68.2c522348.js"><link rel="prefetch" href="/assets/js/69.21442473.js"><link rel="prefetch" href="/assets/js/7.18c81a0e.js"><link rel="prefetch" href="/assets/js/70.01c26412.js"><link rel="prefetch" href="/assets/js/71.abc190e4.js"><link rel="prefetch" href="/assets/js/72.c63e6daa.js"><link rel="prefetch" href="/assets/js/73.63aee2ed.js"><link rel="prefetch" href="/assets/js/74.a5bf3564.js"><link rel="prefetch" href="/assets/js/75.80543035.js"><link rel="prefetch" href="/assets/js/76.431071ff.js"><link rel="prefetch" href="/assets/js/77.ce3cabc9.js"><link rel="prefetch" href="/assets/js/78.7c959c4d.js"><link rel="prefetch" href="/assets/js/79.06c26c0a.js"><link rel="prefetch" href="/assets/js/8.fa1b2a2c.js"><link rel="prefetch" href="/assets/js/80.abf0bff0.js"><link rel="prefetch" href="/assets/js/81.7f07bb27.js"><link rel="prefetch" href="/assets/js/82.a0b063ec.js"><link rel="prefetch" href="/assets/js/83.168f0843.js"><link rel="prefetch" href="/assets/js/84.4c091942.js"><link rel="prefetch" href="/assets/js/85.4bd9e377.js"><link rel="prefetch" href="/assets/js/86.7dc85582.js"><link rel="prefetch" href="/assets/js/87.86400caf.js"><link rel="prefetch" href="/assets/js/88.0de12709.js"><link rel="prefetch" href="/assets/js/89.0f2a88c2.js"><link rel="prefetch" href="/assets/js/9.98404b8c.js"><link rel="prefetch" href="/assets/js/90.e63ee580.js"><link rel="prefetch" href="/assets/js/91.c87d9531.js"><link rel="prefetch" href="/assets/js/92.51f5dab6.js"><link rel="prefetch" href="/assets/js/93.b424b143.js"><link rel="prefetch" href="/assets/js/94.87455eb8.js"><link rel="prefetch" href="/assets/js/95.2251c10e.js"><link rel="prefetch" href="/assets/js/96.8f341aa4.js"><link rel="prefetch" href="/assets/js/97.612d7357.js"><link rel="prefetch" href="/assets/js/98.0b1b8468.js"><link rel="prefetch" href="/assets/js/99.dfa80316.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">JuneJH</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/blog/1.html" class="nav-link">
  vue相关
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/blog/1.html" class="nav-link">
  vue相关
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span></span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>O M</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Code</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Css</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Data Visualization</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Full Stack</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Html</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Http</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Javascript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Package Manager</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>React</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Typescript</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vite</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Vue</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vue/1.关于vue的使用.html" class="sidebar-link">复盘Vue使用</a></li><li><a href="/vue/2.关于vue的生命周期.html" class="sidebar-link">学习vue的生命周期</a></li><li><a href="/vue/3.关于vueRouter.html" class="sidebar-link">关于vueRouter</a></li><li><a href="/vue/4.关于vuex.html" class="sidebar-link">关于Vuex相关</a></li><li><a href="/vue/5.关于vue全局Api.html" class="sidebar-link">Vue.api实现源码分析</a></li><li><a href="/vue/vue3使用.html" class="sidebar-link">Vue3使用</a></li><li><a href="/vue/vue3变化.html" class="active sidebar-link">vue3的性能</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vue/vue3变化.html#_1-静态提升" class="sidebar-link">1. 静态提升</a></li><li class="sidebar-sub-header"><a href="/vue/vue3变化.html#_2-预字符串化" class="sidebar-link">2. 预字符串化</a></li><li class="sidebar-sub-header"><a href="/vue/vue3变化.html#_3-缓存事件处理函数" class="sidebar-link">3. 缓存事件处理函数</a></li><li class="sidebar-sub-header"><a href="/vue/vue3变化.html#_4-block-tree" class="sidebar-link">4. Block Tree</a></li><li class="sidebar-sub-header"><a href="/vue/vue3变化.html#_5-patchflag" class="sidebar-link">5. patchFlag</a></li><li class="sidebar-sub-header"><a href="/vue/vue3变化.html#去掉vue构造函数" class="sidebar-link">去掉Vue构造函数</a></li><li class="sidebar-sub-header"><a href="/vue/vue3变化.html#组件实例" class="sidebar-link">组件实例</a></li><li class="sidebar-sub-header"><a href="/vue/vue3变化.html#vue3-模版变化" class="sidebar-link">vue3 模版变化</a></li><li class="sidebar-sub-header"><a href="/vue/vue3变化.html#组件的变化" class="sidebar-link">组件的变化</a></li><li class="sidebar-sub-header"><a href="/vue/vue3变化.html#响应式数据-reactivity-api" class="sidebar-link">响应式数据 reactivity api</a></li></ul></li><li><a href="/vue/vue全家桶实践.html" class="sidebar-link">vue技术框架实践</a></li><li><a href="/vue/vue响应式方案.html" class="sidebar-link">vue 实现响应式方案</a></li><li><a href="/vue/vue的diff算法策略.html" class="sidebar-link">vue diff算法策略</a></li><li><a href="/vue/vue的批量异步更新策略.html" class="sidebar-link">Vue的批量异步更新策略</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Webpack</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue3的性能"><a href="#vue3的性能" class="header-anchor">#</a> vue3的性能</h1> <h2 id="_1-静态提升"><a href="#_1-静态提升" class="header-anchor">#</a> 1. 静态提升</h2> <blockquote><p>提升静态节点
提升静态属性</p></blockquote> <ol><li>把静态节点保存在外部</li> <li>把静态属性保存在外部</li></ol> <h2 id="_2-预字符串化"><a href="#_2-预字符串化" class="header-anchor">#</a> 2. 预字符串化</h2> <blockquote><p>把大量连续的静态节点编译为字符串的节点</p></blockquote> <h2 id="_3-缓存事件处理函数"><a href="#_3-缓存事件处理函数" class="header-anchor">#</a> 3. 缓存事件处理函数</h2> <blockquote><p>把不会变的事件处理函数缓存起来</p></blockquote> <h2 id="_4-block-tree"><a href="#_4-block-tree" class="header-anchor">#</a> 4. Block Tree</h2> <blockquote><p>在最近的跟节点记录动态节点,方便比较</p></blockquote> <h2 id="_5-patchflag"><a href="#_5-patchflag" class="header-anchor">#</a> 5. patchFlag</h2> <blockquote><p>标记动态位置
记录动态数据的位置,比如文本、class等属性通过不同的状态,让vue在更新是准确找到变化点
不用像vue2中全量更新属性,提升效率</p></blockquote> <ol><li></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token punctuation">{</span>
    <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">TEXT</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">CLASS</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">STYLE</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">PROPS</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">FULL_PROPS</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">HYDRATE_EVENTS</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">STABLE_FRAGMENT</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">128</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">KEYED_FRAGMENT</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">256</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">UNKEYED_FRAGMENT</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">512</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">NEED_PATCH</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">1024</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">DYNAMIC_SLOTS</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token number">2048</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">DEV_ROOT_FRAGMENT</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">HOISTED</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">BAIL</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="去掉vue构造函数"><a href="#去掉vue构造函数" class="header-anchor">#</a> 去掉Vue构造函数</h2> <ul><li>当一个页面有多个vue应用使用插件时</li> <li>通过函数导出,有利于tree shaking</li> <li>区分开vue应用和vue组件</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// vue2  影响所有的vue应用</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span>
Vue<span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// vue3 </span>
<span class="token function">createApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mixin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="组件实例"><a href="#组件实例" class="header-anchor">#</a> 组件实例</h2> <blockquote><p>在vue2中组件实例存在许多不想开发者使用的属性/方法
在vue3中组件实例是一个Proxy的代理对象</p></blockquote> <h2 id="vue3-模版变化"><a href="#vue3-模版变化" class="header-anchor">#</a> vue3 模版变化</h2> <h3 id="_1-v-model"><a href="#_1-v-model" class="header-anchor">#</a> 1. v-model</h3> <blockquote><p>由于在vue2中v-model和.sync都是用来双向绑定的,无论使用上还是语义上都不是很友好
在vue3中双向绑定只能通过v-model
通过??Modifiers属性可获得修饰符参数</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;VModel v-model=&quot;vmodel&quot; v-model:title.j=&quot;title&quot;/&gt;</span><span class="token template-punctuation string">`</span></span>
funciton <span class="token function">inputHandle</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  ctx<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;update:modelValue&quot;</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">clickHandle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>props<span class="token punctuation">.</span>titleModifiers <span class="token operator">&amp;&amp;</span> props<span class="token punctuation">.</span>titleModifiers<span class="token punctuation">.</span>j<span class="token punctuation">)</span><span class="token punctuation">{</span>
    ctx<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;update:title&quot;</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  ctx<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;update:title&quot;</span><span class="token punctuation">,</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="_2-v-for-v-if"><a href="#_2-v-for-v-if" class="header-anchor">#</a> 2. v-for v-if</h3> <blockquote><p>在vue2中v-for指令的优先级高于v-if,但是依旧不建议一同使用,对性能及其不友好
在vue3中v-for指令的优先级低于v-if,所以在一同使用时,v-if中无法读到v-for遍历的值,从根本上断绝他们一同使用的情况
在vue3中使用计算属性来代替v-for和v-if一同使用的情况</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
  isShow<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span><span class="token string">&quot;first item&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
  isShow<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span><span class="token string">&quot;sec item&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
  isShow<span class="token operator">:</span><span class="token boolean">true</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span><span class="token string">&quot;three item&quot;</span>
<span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token keyword">const</span> computeListRef <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>list<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>item<span class="token punctuation">.</span>isShow<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h3 id="_3-key"><a href="#_3-key" class="header-anchor">#</a> 3. key</h3> <blockquote><p>key值在vue3中可以赋值template
key在分支节点上将自行分配一个唯一的key</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 在vue2中input将会被复用,而在vue3中不会</span>
<span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">if</span><span class="token operator">=</span><span class="token string">&quot;isShow&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>label key<span class="token operator">=</span><span class="token string">&quot;1&quot;</span><span class="token operator">&gt;</span> 姓名：<span class="token operator">&lt;</span>input <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>div v<span class="token operator">-</span><span class="token keyword">else</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>label key<span class="token operator">=</span><span class="token string">&quot;1&quot;</span><span class="token operator">&gt;</span> 昵称：<span class="token operator">&lt;</span>input <span class="token operator">/</span><span class="token operator">&gt;</span> <span class="token operator">&lt;</span><span class="token operator">/</span>label<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>button @click<span class="token operator">=</span><span class="token string">&quot;isShow = !isShow&quot;</span><span class="token operator">&gt;</span>更改显示<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

</code></pre></div><h3 id="_4-可以存在多个根"><a href="#_4-可以存在多个根" class="header-anchor">#</a> 4. 可以存在多个根</h3> <blockquote><p>vue3支持多个根节点
在vue2中一个组件必须有一个根节点,这样有时候是冗余</p></blockquote> <h2 id="组件的变化"><a href="#组件的变化" class="header-anchor">#</a> 组件的变化</h2> <blockquote><p>defineAsyncComponent 异步组件
Teleport 改变组件实例真实位置
Suspence</p></blockquote> <h2 id="响应式数据-reactivity-api"><a href="#响应式数据-reactivity-api" class="header-anchor">#</a> 响应式数据 reactivity api</h2> <blockquote><p>利用Proxy Api实现
对数据时动态访问的
vue3中把响应式系统为单独的一个模块
其中reactive、ref、readonly、computed为生成响应式数据API
其中reactive、readonly生成的是代理对象Proxy
ref、computed生成的是ref对象</p></blockquote> <h3 id="_1-reactive、readonly"><a href="#_1-reactive、readonly" class="header-anchor">#</a> 1. reactive、readonly</h3> <ul><li>reactive(Object) 代理一个对象new Proxy()</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token function">reactive</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//value cannot be made reactive: 123</span>

</code></pre></div><ul><li>readonly(Object) 代理一个对象,不提供set()</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> state <span class="token operator">=</span> <span class="token function">readonly</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;june&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
state<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token number">123</span><span class="token comment">//Set operation on key &quot;name&quot; failed: target is readonly. {name: &quot;june&quot;}</span>

</code></pre></div><h3 id="_2-ref、computed"><a href="#_2-ref、computed" class="header-anchor">#</a> 2. ref、computed</h3> <ul><li>可以让所有类型状态具有响应式</li> <li>如果是非对象类型,直接ref.value</li> <li>如果是对象,ref.value = Proxy对象</li> <li>如果是Proxy对象,直接使用该Proxy对象</li> <li>computed返回的是一个ref对象</li> <li>computed会缓存结果,依赖发生变化时且再次调用该计算属性时重新执行计算函数得到新值</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> numberRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// {value:123}</span>
<span class="token keyword">const</span> userRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;june&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//{value:Proxy}</span>
<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token function">reactive</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token operator">:</span><span class="token string">&quot;june&quot;</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> userReactiveRef <span class="token operator">=</span> <span class="token function">ref</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>userReactiveRef<span class="token punctuation">.</span>value <span class="token operator">===</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// true</span>
<span class="token keyword">const</span> userInfo <span class="token operator">=</span> <span class="token function">computed</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">My name is </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>userRef<span class="token punctuation">.</span>value<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">,i am </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>user<span class="token punctuation">.</span>age<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string"> year old</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>

</code></pre></div><h3 id="_3-工具方法"><a href="#_3-工具方法" class="header-anchor">#</a> 3. 工具方法</h3> <ul><li>isProxy</li> <li>isReactive</li> <li>isReadonly</li> <li>unref</li> <li>toRef</li> <li>toRefs</li> <li>isRef</li></ul> <h3 id="_4-watch、watcheffect"><a href="#_4-watch、watcheffect" class="header-anchor">#</a> 4. watch、watchEffect</h3> <blockquote><p>watch:同vue2的使用,惰性执行副作用,手动指定监听对象,可访问当前状态和修改前状态
watchEffect:在响应式地跟踪其依赖项时立即运行一个函数，并在更改依赖项时重新运行它
watchEffect会自动收集依赖</p></blockquote> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token function">watch</span><span class="token punctuation">(</span>numberRef<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span>preState</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;watch run&quot;</span><span class="token punctuation">,</span>state<span class="token punctuation">,</span>preState<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token function">watchEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;watchEffect run&quot;</span><span class="token punctuation">,</span>numberRef<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// watch 通过数组监听多个依赖,Proxy对象需要转换为一个函数</span>
<span class="token function">watch</span><span class="token punctuation">(</span><span class="token punctuation">[</span>numberRef<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span>state<span class="token punctuation">.</span>name<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>state<span class="token punctuation">,</span>preState<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>name<span class="token punctuation">,</span>preName<span class="token punctuation">]</span></span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;watch run 2&quot;</span><span class="token punctuation">,</span>state<span class="token punctuation">,</span>preState<span class="token punctuation">,</span>name<span class="token punctuation">,</span>preName<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/vue/vue3使用.html" class="prev">
        Vue3使用
      </a></span> <span class="next"><a href="/vue/vue全家桶实践.html">
        vue技术框架实践
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.75473690.js" defer></script><script src="/assets/js/2.8c11f49f.js" defer></script><script src="/assets/js/100.acece0c3.js" defer></script>
  </body>
</html>
